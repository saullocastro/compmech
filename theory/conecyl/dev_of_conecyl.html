
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Developing the code for the conecyl module &#8212; CompMech 0.8.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script src="../../_static/documentation_options.js?v=486e5634"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'theory/conecyl/dev_of_conecyl';</script>
    <link rel="icon" href="../../_static/logo.png"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Equivalent Single Layer (ESL) Theories" href="esl_theories.html" />
    <link rel="prev" title="Semi-Analytical Models for Conical and Cylindrical Shells (conecyl)" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Nov 20, 2023"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="CompMech 0.8.0 documentation - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="CompMech 0.8.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../modules/index.html">
                        Modules
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Theory, Implementation and Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../about.html">
                        About
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../next_steps.html">
                        Next Steps
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dev/index.html">
                        Contributing to CompMech
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../modules/index.html">
                        Modules
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Theory, Implementation and Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../about.html">
                        About
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../next_steps.html">
                        Next Steps
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dev/index.html">
                        Contributing to CompMech
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Semi-Analytical Models for Conical and Cylindrical Shells (conecyl)</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Developing the code for the conecyl module</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="esl_theories.html">Equivalent Single Layer (ESL) Theories</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="clpt.html">CLPT - Classical Laminated Plate Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="fsdt.html">FSDT - First-order Shear Deformation Theory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bcs.html">Boundary conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref.html">References</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fem/index.html">Finite Element Method</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fem/elem_stiff_matrix.html">Element Stiffness Matrix</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../func/index.html">Approximation Functions Used in Various Models</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../func/bardell.html">Bardell’s Hierarchical Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../func/ref.html">References</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../integrate/index.html">Numerical Integration Methods</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../integrate/legendre_gauss.html">Legendre-Gauss Quadrature Points</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integrate/ref.html">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../meshfree/index.html">Meshfree Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ref.html">References</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Theory, Implementation and Tutorials</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Semi-Analytical Models for Conical and Cylindrical Shells (conecyl)</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Developing...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="developing-the-code-for-the-conecyl-module">
<h1>Developing the code for the conecyl module<a class="headerlink" href="#developing-the-code-for-the-conecyl-module" title="Link to this heading">#</a></h1>
<section id="history-about-the-software-used-to-derive-the-equations">
<h2>History about the software used to derive the equations<a class="headerlink" href="#history-about-the-software-used-to-derive-the-equations" title="Link to this heading">#</a></h2>
<p>The equations are symbolically evaluated using a matrix notation, as explained
in FIXME ADD REFERENCES.
Initially the project used SymPy to derive the integrands and to perform the
analytical integrations. Since SymPy showed to be very slow for the integrands
herein evaluated, SymPy was used to derive the integrands and Mathematica used
to perform the integrations. This required a considerable effort on data
management and therefore it was decided to move the derivation of the
integrands inside Mathematica. Now in Mathematica it is derived all the
integrands, the analytical integration calculated and the symbolic
simplifications performed, which is also an important and computationally
expensive step.</p>
<p>SymPy is used to post process the results from Mathematica and print the
matrices in a ready-to-paste-into-Cython form.</p>
</section>
<section id="current-implementations">
<h2>Current implementations<a class="headerlink" href="#current-implementations" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>static analysis (linear or non-linear)</p></li>
<li><p>buckling analysis (linear or non-linear, using initial imperfections)</p></li>
<li><p>load conditions: axial compression, torsion, pressure and any set of
surface loads, concentraded or not</p></li>
</ul>
</section>
<section id="definitions">
<h2>Definitions<a class="headerlink" href="#definitions" title="Link to this heading">#</a></h2>
<p>In the <a class="reference internal" href="esl_theories.html#esl-theories"><span class="std std-ref">ESL theories section</span></a> it is explained
the types of kinematic equation implemented, defining the <code class="docutils literal notranslate"><span class="pre">ESL</span> <span class="pre">theory</span></code>
prefix mentioned below (currently <code class="docutils literal notranslate"><span class="pre">clpt</span></code> or <code class="docutils literal notranslate"><span class="pre">fsdt</span></code>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">equation</span> <span class="pre">type</span></code> prefix will be <code class="docutils literal notranslate"><span class="pre">donnell</span></code> or <code class="docutils literal notranslate"><span class="pre">sanders</span></code>, defining
if the model is built using the Donnell’s or the Sanders’ non-linear
equations.</p>
</section>
<section id="integration-of-the-linear-matrices">
<h2>Integration of the linear matrices<a class="headerlink" href="#integration-of-the-linear-matrices" title="Link to this heading">#</a></h2>
<p>The linear matrices K0 and KG0 are integrated analytically, and the
Mathematica routines necessary for this task are named as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">ESL</span> <span class="n">theory</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">equation</span> <span class="nb">type</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">boundary</span> <span class="n">condition</span><span class="p">}</span><span class="n">_linear</span><span class="o">.</span><span class="n">nb</span>
</pre></div>
</div>
<p>Each integrated smallest repeatable sub-matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">00</span><span class="p">,</span> <span class="mi">01</span><span class="p">,</span> <span class="mi">02</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span> <span class="ow">and</span> <span class="mi">22</span>
</pre></div>
</div>
<p>are stored in two text files inside the folder <code class="docutils literal notranslate"><span class="pre">./linear_mathematica</span></code>,
one with a Mathematica format and another in Fortran format,
identified with a prefix
<code class="docutils literal notranslate"><span class="pre">fortran_</span></code>. Since the integrated matrices are greatly simplified for the
cylinder case, there are files for both cones and cylinders.</p>
<p>The routine <code class="docutils literal notranslate"><span class="pre">print_linear_sparse.py</span></code> is used to convert the Fortran
format to a
ready-to-past-in-Cython format, separating in <code class="docutils literal notranslate"><span class="pre">row</span></code>, <code class="docutils literal notranslate"><span class="pre">col</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code>,
which is convenient for the implementation using sparse matrices. The
generated files are stored in <code class="docutils literal notranslate"><span class="pre">./linear_sparse</span></code>. Note that the power
functions <code class="docutils literal notranslate"><span class="pre">var**3</span></code> are transformed in <code class="docutils literal notranslate"><span class="pre">(var*var*var)</span></code>, by default,
which can be modified by changing the parameters in the
<code class="docutils literal notranslate"><span class="pre">mprint_as_sparse()</span></code> function.</p>
<p>The integrated sparse matrices are pasted in the corresponding Cython codes,
currently:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clpt_donnell_bcX_linear</span><span class="o">.</span><span class="n">pyx</span>
<span class="n">clpt_sanders_bcX_linear</span><span class="o">.</span><span class="n">pyx</span>
<span class="n">fsdt_donnell_bcX_linear</span><span class="o">.</span><span class="n">pyx</span>
</pre></div>
</div>
</section>
<section id="integration-of-the-non-linear-matrices">
<h2>Integration of the non-linear matrices<a class="headerlink" href="#integration-of-the-non-linear-matrices" title="Link to this heading">#</a></h2>
<p>The non-linear matrices <code class="docutils literal notranslate"><span class="pre">K0L</span></code>, <code class="docutils literal notranslate"><span class="pre">KG</span></code> and <code class="docutils literal notranslate"><span class="pre">KLL</span></code> are not integrated
analytically and their integrands are built for the numerical integration
algorithms. Mathematica is used to build the integrands, in the routines
named as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">ESL</span> <span class="n">theory</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">equation</span> <span class="nb">type</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">boundary</span> <span class="n">condition</span><span class="p">}</span><span class="n">_nonlinear</span><span class="o">.</span><span class="n">nb</span>
</pre></div>
</div>
<p>The output is printed inside <code class="docutils literal notranslate"><span class="pre">./nonlinear_mathematica</span></code> and the routine
<code class="docutils literal notranslate"><span class="pre">print_nonlinear_sparse.py</span></code> is used to parse these results into something
that can be directly implemented into Cython, and the new outputs are
stored in <code class="docutils literal notranslate"><span class="pre">./nonlinear_sparse</span></code>.</p>
<p>For each sub-matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">00</span><span class="p">,</span> <span class="mi">01</span><span class="p">,</span> <span class="mi">02</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span>
</pre></div>
</div>
<p>there will be a corresponding file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fortran_</span><span class="p">{</span><span class="n">cone</span> <span class="ow">or</span> <span class="n">cylinder</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">matrix</span> <span class="n">name</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">sub</span><span class="o">-</span><span class="n">matrix</span><span class="p">}</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>The sub-matrix is identified by a left and a right digit (<code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code> or
<code class="docutils literal notranslate"><span class="pre">2</span></code>) that indicate the region of the stiffness matrix that this
sub-matrix refers to.</p>
<p>The sub-matrices’ integrands are printed in a format ready to be programmed
using sparse matrices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">rows</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">cols</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">col</span><span class="o">+</span><span class="mi">4</span>
<span class="n">out</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="n">out</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">p00</span><span class="o">*</span><span class="n">q04</span> <span class="o">+</span> <span class="n">p01</span><span class="o">*</span><span class="n">q14</span> <span class="o">+</span> <span class="n">p02</span><span class="o">*</span><span class="n">q24</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code> are arguments passed by the numerical integration
algorithm (they give a pre-calculated weight for the point being integrated),
<code class="docutils literal notranslate"><span class="pre">pij</span></code> are the left <code class="docutils literal notranslate"><span class="pre">qij</span></code> the right components of the integrand.</p>
<p>The definitions of <code class="docutils literal notranslate"><span class="pre">pij</span></code> and <code class="docutils literal notranslate"><span class="pre">qij</span></code> are given in the corresponding files
with a <code class="docutils literal notranslate"><span class="pre">p</span></code> and a <code class="docutils literal notranslate"><span class="pre">q</span></code> character after the matrix name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fortran_</span><span class="p">{</span><span class="n">cone</span> <span class="ow">or</span> <span class="n">cylinder</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">matrix</span> <span class="n">name</span><span class="p">}</span><span class="n">p_</span><span class="p">{</span><span class="n">left</span> <span class="n">digit</span><span class="p">}</span><span class="o">.</span><span class="n">txt</span>
<span class="n">fortran_</span><span class="p">{</span><span class="n">cone</span> <span class="ow">or</span> <span class="n">cylinder</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">matrix</span> <span class="n">name</span><span class="p">}</span><span class="n">q_</span><span class="p">{</span><span class="n">right</span> <span class="n">digit</span><span class="p">}</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>For example, to calculate the smallest repeatable sub-matrix <code class="docutils literal notranslate"><span class="pre">12</span></code> of
<code class="docutils literal notranslate"><span class="pre">KG</span></code>, first the file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fortran_cone_kG_12</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>should be openened, and the definitions for <code class="docutils literal notranslate"><span class="pre">pij</span></code> are found in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fortran_cone_kGNLp_1</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>and the definitions for <code class="docutils literal notranslate"><span class="pre">qij</span></code> are found in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fortran_cone_kGNLq_2</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>These are implemented in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clpt_donnell_bcX_nonlinear</span><span class="o">.</span><span class="n">pyx</span>
<span class="n">clpt_sanders_bcX_nonlinear</span><span class="o">.</span><span class="n">pyx</span>
<span class="n">fsdt_donnell_bcX_nonlinear</span><span class="o">.</span><span class="n">pyx</span>
</pre></div>
</div>
</section>
<section id="strain-equations">
<h2>Strain Equations<a class="headerlink" href="#strain-equations" title="Link to this heading">#</a></h2>
<p>When the non-linear integrands are built another file containing the
strain equations is written:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fortran_strainFunc</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>This file is processed using the routine:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">print_strainFunc</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>which creates the output files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output_strainFunc</span><span class="o">.</span><span class="n">txt</span>
<span class="n">output_e0</span><span class="o">.</span><span class="n">txt</span>
<span class="n">output_eL</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>the first with the full strain relations, the second with the linear
and the third with the non-linear strain relations. The format saved
is easy to implement in the Cython codes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clpt_commons_bcX</span><span class="o">.</span><span class="n">pyx</span>
<span class="n">fsdt_commons_bcX</span><span class="o">.</span><span class="n">pyx</span>
</pre></div>
</div>
</section>
<section id="internal-forces">
<h2>Internal Forces<a class="headerlink" href="#internal-forces" title="Link to this heading">#</a></h2>
<p>The internal force vector <span class="math notranslate nohighlight">\(\{F_{int}\}\)</span> is separated in four parts:</p>
<div class="math notranslate nohighlight">
\[\{F_{int}\} = \{F_{int}\}_{00} + \{F_{int}\}_{0L} +
              \{F_{int}\}_{L0} + \{F_{int}\}_{LL}\]</div>
<p>As can be seen in function <a class="reference internal" href="../../modules/conecyl/index.html#compmech.conecyl.ConeCyl.calc_fint" title="compmech.conecyl.ConeCyl.calc_fint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compmech.conecyl.ConeCyl.calc_fint()</span></code></a>,
the linear component <span class="math notranslate nohighlight">\(\{F_{int}\}_{00}\)</span> is calculated using:</p>
<div class="math notranslate nohighlight">
\[\{F_{int}\}_{00} = [K_0]\{c\}\]</div>
<p>because <span class="math notranslate nohighlight">\([K_0]\)</span> is calculated analytically and the numerical integration
errors are avoided in this way. For the other three terms <span class="math notranslate nohighlight">\(0L\)</span>, <span class="math notranslate nohighlight">\(L0\)</span> and
<span class="math notranslate nohighlight">\(LL\)</span>, a numerical integration is performed. It is important
to say that computational cost associated
with the numerical integration of <span class="math notranslate nohighlight">\(\{F_{int}\}\)</span> is approximately
<span class="math notranslate nohighlight">\(m_2 \times n_2\)</span> smaller than the integraion of <span class="math notranslate nohighlight">\([K_T]\)</span>.</p>
<p>The Mathematica routine:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">ESL</span> <span class="n">theory</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">equation</span> <span class="nb">type</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">boundary</span> <span class="n">condition</span><span class="p">}</span><span class="n">_nonlinear</span><span class="o">.</span><span class="n">nb</span>
</pre></div>
</div>
<p>produces a file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fortran_fint_L0_0L_LL</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>which is post-processed by the routine:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">print_fint_L0_0L_LL</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>that prints into <code class="docutils literal notranslate"><span class="pre">./nonlinear_sparse</span></code> in a ready-to-paste format, that
is copy-pasted in Cython.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Semi-Analytical Models for Conical and Cylindrical Shells (conecyl)</p>
      </div>
    </a>
    <a class="right-next"
       href="esl_theories.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Equivalent Single Layer (ESL) Theories</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#history-about-the-software-used-to-derive-the-equations">History about the software used to derive the equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#current-implementations">Current implementations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-of-the-linear-matrices">Integration of the linear matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-of-the-non-linear-matrices">Integration of the non-linear matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strain-equations">Strain Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-forces">Internal Forces</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../../_sources/theory/conecyl/dev_of_conecyl.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2012-2023 Saullo G. P. Castro.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>